# プログラミング課題 評価ルーブリック (自動採点用)

Version: 3.0

## 判定記号の定義

| 記号 | 意味 | 使用条件 |
|------|------|---------|
| **[OK]** | 基準を十分に満たしている | 具体的証拠（file:line, commit hash, コマンド出力）が必須 |
| **[WARN]** | 部分的にできているが改善の余地あり | 理由と改善提案を明記 |
| **[NG]** | 基準を満たしていない / 未実装 | 不足している内容を具体的に明記 |

**注意**: 証拠が得られない場合は推測で [OK] を付けず、[WARN] + 理由を明記すること。

---

## カテゴリ A: Git・開発プロセス（担当: git_process）

### G1: コミット粒度・メッセージ

- **チェック対象**: `git log --oneline --all --graph`
- **[OK]**: 1コミット1作業単位。プレフィックス（`feat:`, `fix:`, `docs:` 等）が一貫して使用されている。
- **[WARN]**: プレフィックスはあるが不統一、または一部のコミットが大きすぎる。
- **[NG]**: メッセージが「update」「fix」のみ、または1コミットに複数の無関係な変更が含まれる。

### G2: タスク・Issue管理

- **チェック対象**: `gh issue list --state all`, GitHub Projects
- **[OK]**: タスクが GitHub Issue で管理され、ラベルやマイルストーンで優先順位が可視化されている。
- **[WARN]**: Issue は存在するが、ラベルや優先順位付けがない。
- **[NG]**: Issue が存在しない、またはタスク管理の痕跡がない。

### G3: PRレビュー・マージ判断

- **チェック対象**: `gh pr list --state all`, PR のコメント・レビュー履歴
- **[OK]**: 他者の PR にレビューコメントがある、またはセルフレビューのチェックリストが活用されている。
- **[WARN]**: PR は作成されているがレビューコメントがない。
- **[NG]**: PR が存在しない、または main への直接 push のみ。

### G4: バグ分析・特定

- **チェック対象**: Issue（bug ラベル）、PR description
- **[OK]**: バグ Issue に発生条件・再現手順・影響範囲が記載されている。
- **[WARN]**: バグ Issue はあるが、再現手順や詳細が不足。
- **[NG]**: バグ管理の痕跡がない。

### G5: 修正方針の導出

- **チェック対象**: PR description、Issue コメント
- **[OK]**: 修正方針・影響範囲が PR description やコメントに明記されている。
- **[WARN]**: 修正内容は読み取れるが、方針の明文化がない。
- **[NG]**: 修正の経緯が追跡できない。

### G6: ブランチ戦略

- **チェック対象**: `git branch -a` のパターン分析、ドキュメント内のブランチ方針記載
- **[OK]**: ブランチ命名が一貫（`feature/`, `fix/` 等のプレフィックス使用）、ブランチ戦略がドキュメント化されている、マージ戦略が明確。
- **[WARN]**: 命名パターンは概ね統一されているが一部不統一、または戦略の明文化がない。
- **[NG]**: main のみで開発、またはブランチ命名が完全に不統一。

---

## カテゴリ B: コード品質・設計（担当: code_quality）

### C1: 入力値検証・防衛的プログラミング

- **チェック対象**: コントローラー / ハンドラー / フォーム処理のソースコード
- **[OK]**: ユーザー入力に対してバリデーション（型チェック、範囲チェック、必須チェック）が実装されている。例: `zod`, `class-validator`, `joi` 等のライブラリ使用、または手動バリデーション。
- **[WARN]**: 一部の入力にはバリデーションがあるが、漏れがある。
- **[NG]**: バリデーションが存在しない。ユーザー入力を無検証で使用している。

### C2: 例外処理

- **チェック対象**: ソースコード全般の try-catch / エラーハンドリング
- **[OK]**: 適切な粒度で例外処理が実装され、ユーザーへのフィードバックやログ出力がある。
- **[WARN]**: try-catch はあるが、catch ブロックが `console.log` のみ、または範囲が広すぎる。
- **[NG]**: 例外処理が存在しない、または catch ブロックが空。

### C3: 静的解析ツール

- **チェック対象**: `.eslintrc*`, `.prettierrc*`, `pyproject.toml`, `rubocop.yml`, `.editorconfig`, `biome.json` 等
- **[OK]**: リンター・フォーマッターの設定ファイルが存在し、ルールがカスタマイズされている。Husky や lint-staged での自動化があれば加点。
- **[WARN]**: 設定ファイルはあるがデフォルトのまま、または一部ツールのみ。
- **[NG]**: 静的解析ツールの設定が存在しない。

### C4: 命名規則

- **チェック対象**: ソースコードの変数名・関数名・クラス名
- **[OK]**: 言語の慣習に沿った命名規則（TypeScript: camelCase / PascalCase、Python: snake_case）が一貫している。変数名が意味を表している。
- **[WARN]**: 概ね統一されているが、一部に `data`, `info`, `tmp` 等の曖昧な命名がある。
- **[NG]**: 命名規則が不統一。意味不明な変数名が多数。配列に単数形を使用（例: `style: string[]`）。

### C5: ディレクトリ構造

- **チェック対象**: プロジェクトのファイルツリー
- **[OK]**: 役割ごとにディレクトリが分類されている（例: `components/`, `services/`, `models/`, `utils/`）。
- **[WARN]**: 分類はあるが、一部のファイルが不適切な場所に配置されている。
- **[NG]**: フラットな構造で分類がない、またはルートに多数のファイルが散在。

### C6: DRY原則・単一責任

- **チェック対象**: ソースコード全般
- **[OK]**: コピペコードがない。ビジネスロジック・UI・データアクセスが適切に分離されている。
- **[WARN]**: 一部に重複コードがある、または責務の分離が不十分な箇所がある。
- **[NG]**: 大量のコピペコード。1ファイルに複数の責務が混在。

### C7: ログ設計

- **チェック対象**: ロガーライブラリの使用状況、ログ出力箇所
- **[OK]**: `winston`, `pino`, `logging` 等の専用ロガーを使用。ログレベル（info, error, debug）が適切に使い分けられている。
- **[WARN]**: ロガーは導入されているが、ログレベルの使い分けが不十分、または一部で `console.log` が残っている。
- **[NG]**: `console.log` のみでログ設計がない。

### C8: セキュリティ対策

- **チェック対象**: DB アクセス、HTML 出力、認証・認可、環境変数管理
- **[OK]**: SQLインジェクション対策（ORM / プレースホルダ使用）、XSS対策（エスケープ / サニタイズ）、機密情報が `.env` で管理され `.gitignore` に含まれている。
- **[WARN]**: 一部の対策はあるが、漏れがある（例: `.env` はあるが `.gitignore` に未記載）。
- **[NG]**: セキュリティ対策の痕跡がない。SQL 文字列結合、機密情報のハードコード等。

### C9: パフォーマンス・キャッシュ

- **チェック対象**: DB クエリ、API 呼出、キャッシュ設定
- **[OK]**: N+1 問題への対策（eager loading 等）がある。キャッシュ（Redis, in-memory 等）の活用がある。
- **[WARN]**: 明らかな N+1 はないが、パフォーマンスへの意識的な対策は見られない。
- **[NG]**: N+1 問題が存在する。大量データの非効率な処理がある。

### C10: アーキテクチャ

- **チェック対象**: 全体的なディレクトリ設計、レイヤー構成
- **[OK]**: システム要件に対してシンプルかつ拡張性のある構成。レイヤードアーキテクチャやクリーンアーキテクチャ等の設計思想が読み取れる。
- **[WARN]**: 構成は概ね適切だが、一部にレイヤー違反や不明確な依存関係がある。
- **[NG]**: 設計思想が読み取れない。全機能がモノリシックに1ファイルに集約されている。

---

## カテゴリ C: テスト・CI/CD（担当: testing_cicd）

### T1: テスト設計書

- **チェック対象**: テスト方針ドキュメント（Markdown, Wiki 等）
- **[OK]**: テストの目的・スコープ・方針を記したドキュメントが存在する。
- **[WARN]**: README 等にテスト方針の記載があるが、独立したドキュメントではない。
- **[NG]**: テスト方針のドキュメントが存在しない。

### T2: テストケース網羅性

- **チェック対象**: テストコードの内容（正常系・異常系）
- **[OK]**: 正常系だけでなく、異常系（エラー系・境界値）のテストケースが含まれている。
- **[WARN]**: テストはあるが正常系のみ、または網羅性が不十分。
- **[NG]**: テストケースが極めて少ない、または存在しない。

### T3: テストコード実装

- **チェック対象**: `*.test.*`, `*.spec.*`, `test_*` 等のテストファイル
- **[OK]**: テストコードが存在し、ステートレス（純粋関数）・ステートフル（副作用あり）の両パターンが考慮されている。
- **[WARN]**: テストファイルは存在するが、カバレッジが低い、または特定のパターンのみ。
- **[NG]**: テストコードが存在しない。

### T4: 依存性管理（Mock）

- **チェック対象**: テストコード内の Mock / Stub 使用状況
- **[OK]**: DB や外部 API への接続部分が Mock 化され、テストが外部依存から分離されている。
- **[WARN]**: 一部 Mock 化されているが、外部依存が残るテストがある。
- **[NG]**: Mock が使用されていない。テストが外部サービスに直接依存している。

### T5: CI/CD実装

- **チェック対象**: `.github/workflows/`, `Jenkinsfile`, `.circleci/`, `.gitlab-ci.yml` 等
- **[OK]**: CI/CD パイプラインが設定され、自動ビルド・自動テストが動作している。自動デプロイがあれば加点。
- **[WARN]**: CI/CD 設定ファイルは存在するが、不完全または一部のみ（ビルドのみでテストなし等）。
- **[NG]**: CI/CD の設定が存在しない。

### T6: カバレッジ管理

- **チェック対象**: カバレッジ設定ファイル（jest --coverage, nyc, coverage-py 等）、`package.json` のカバレッジスクリプト、カバレッジレポート
- **[OK]**: カバレッジ目標が明記されている。測定設定あり（`jest --coverage`、`nyc`、`pytest-cov` 等）。カバレッジ改善の痕跡がある。
- **[WARN]**: カバレッジ測定の設定はあるが、目標値が未設定。
- **[NG]**: カバレッジ関連の設定・記載がない。

---

## カテゴリ D: ドキュメント・コミュニケーション（担当: docs_communication）

### D1: コメントの質

- **チェック対象**: ソースコード内のコメント
- **[OK]**: 「なぜ（Why）」や複雑なロジックの説明が書かれている。`TODO:`, `FIXME:`, `NOTE:` 等のタグが活用されている。
- **[WARN]**: コメントはあるが、コードの内容をそのまま繰り返す記述が多い（例: 「値を代入」）。
- **[NG]**: コメントがほぼ存在しない、または全て自動生成。

### D2: READMEの充実度

- **チェック対象**: `README.md`
- **[OK]**: プロジェクト概要、セットアップ手順、環境構築方法、使い方が記載されている。
- **[WARN]**: README は存在するが、セットアップ手順や使い方が不足。
- **[NG]**: README が存在しない、またはほぼ空。

### D3: 設計書の整備

- **チェック対象**: `docs/` ディレクトリ、Wiki、設計関連ファイル
- **[OK]**: API設計書、DB設計書（ER図 / Schema定義）、システム構成図のいずれかがドキュメントとして管理されている。
- **[WARN]**: 一部の設計情報は README や Issue に散在しているが、独立した設計書がない。
- **[NG]**: 設計ドキュメントが存在しない。

### D4: PR記述の適切さ

- **チェック対象**: PR のタイトル・description、PR テンプレート
- **[OK]**: タイトルが明確で、description に変更内容・理由が記載されている。`Closes #123` 等の Issue リンクがある。PR テンプレートの使用があれば加点。
- **[WARN]**: PR は作成されているが、description が不十分。
- **[NG]**: PR が存在しない、または description が空。

### D5: 運用・デプロイ設計

- **チェック対象**: README / docs 内の運用・デプロイ・監視に関する記載
- **[OK]**: デプロイフロー、監視方針、運用コストがドキュメント化されている。
- **[WARN]**: 一部の運用設計はあるが網羅性に欠ける（例: デプロイ手順はあるが監視方針がない）。
- **[NG]**: 運用設計のドキュメントがない。

### D6: スコープ・MVP定義

- **チェック対象**: README / docs の MVP 定義、スコープ記載
- **[OK]**: MVP 定義が明確。優先順位に基づくスコープ定義がある。タスクごとのスコープがドキュメントで明確化されている。
- **[WARN]**: MVP への言及はあるが定義が不明確。
- **[NG]**: スコープ・MVP 関連の記載がない。

---

## 言語別ヒント

### TypeScript / JavaScript

- 静的解析: ESLint, Prettier, Biome
- テスト: Jest, Vitest, Mocha
- ロガー: winston, pino, consola
- バリデーション: zod, joi, class-validator
- ORM: Prisma, TypeORM, Drizzle
- 命名: camelCase (変数・関数), PascalCase (クラス・型・コンポーネント)

### Python

- 静的解析: ruff, flake8, black, mypy
- テスト: pytest, unittest
- ロガー: logging (標準), loguru, structlog
- バリデーション: pydantic, marshmallow
- ORM: SQLAlchemy, Django ORM
- 命名: snake_case (変数・関数), PascalCase (クラス)

### Ruby

- 静的解析: RuboCop, Standard
- テスト: RSpec, Minitest
- ロガー: Logger (標準), Semantic Logger
- バリデーション: ActiveModel Validations, dry-validation
- ORM: ActiveRecord, Sequel
- 命名: snake_case (変数・メソッド), PascalCase (クラス・モジュール)
